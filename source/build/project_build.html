

<!doctype html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Build Guide &#8212; precision-converters-firmware  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../../_static/bizstyle.css?v=532c1bf3" />
    
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Code Styles" href="../code_style.html" />
    <link rel="prev" title="Precision-converters-firmware" href="../../index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../code_style.html" title="Code Styles"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Precision-converters-firmware"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">precision-converters-firmware  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Build Guide</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="build-guide">
<h1>Build Guide<a class="headerlink" href="#build-guide" title="Link to this heading">¶</a></h1>
<details class="summary-build-prerequisites" open>
<summary>Build Prerequisites</summary><blockquote>
<div><p>Prior to building a firmware project, it is required to set up an environment so
that the build process may find the necessary tools (compiler, linker, SDK etc.).
Use the following steps to prepare your environment for building firmware projects
for respective platform.</p>
<details class="summary-windows">
<summary>Windows</summary><details class="summary-mbed">
<summary>Mbed</summary><details class="summary-for-web-online-build">
<summary>For Web/Online Build</summary><ul class="simple">
<li><p>Visit <a class="reference external" href="https://www.keil.arm.com/">Arm Keil website</a> to create an user account for accessing the web based Keil Studio IDE.</p></li>
<li><p>Open <a class="reference external" href="https://studio.keil.arm.com/auth/login/">Keil Studio Web IDE</a> with registered user account</p></li>
</ul>
</details><details class="summary-for-make-build">
<summary>For Make Build</summary><ul class="simple">
<li><p>Clone Precision Converters Firmware repository with the –recursive flag (not needed if building with web IDE for Mbed platform):</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>--recursive<span class="w"> </span>https://github.com/analogdevicesinc/precision-converters-firmware
</pre></div>
</div>
<ul class="simple">
<li><p>If however you’ve already cloned the repository without the –recursive flag, you may initialize all the submodules in an existing cloned repo with:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--recursive<span class="w"> </span>--init
</pre></div>
</div>
<ul>
<li><p>Install <a class="reference external" href="https://gnuwin32.sourceforge.net/packages/make.htm">Make</a> in the root of ‘C’ drive without any spaces in the installation path. The path must be <strong>C:\GnuWin32\…</strong>. Add this path into the system environmental path variable (as shown in below screenshot).</p></li>
<li><p>Install <a class="reference external" href="https://git-scm.com/downloads">Git</a> and add a path of <strong>C:\Program Files\Git\usr\bin\</strong> directory into system environmental path variable (please verify your git installation path is correct).</p></li>
<li><p>Install Mbed CLI 1 as per guide <a class="reference external" href="https://os.mbed.com/docs/mbed-os/v6.15/build-tools/install-and-set-up.html">here</a>.</p></li>
<li><p>Install <a class="reference external" href="https://developer.arm.com/downloads/-/gnu-rm.">GNU Arm Embedded compiler</a> (for the development, 9-2019-q4-major version is used) and add a path of GNU Arm Embedded Toolchain bin directory into the system environmental path variable (as shown in below screenshot).</p></li>
<li><p>Configure the compiler location with Mbed CLI. This can be carried out by running the <strong>mbed config -G GCC_ARM_PATH &lt;path-to-your-gcc-compiler&gt;</strong> in Command Prompt. For example you can run <strong>mbed config -G GCC_ARM_PATH “C:\Program Files (x86)\GNU Tools ARM Embedded\9 2019-q4-major\bin”</strong> in command prompt. It will set mentioned compiler path to all the Mbed Projects.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/environmental_variables.png"><img alt="../../_images/environmental_variables.png" src="../../_images/environmental_variables.png" style="width: 400px;" /></a>
</div></blockquote>
</li>
</ul>
</details></details><details class="summary-stm32">
<summary>STM32</summary><details class="summary-for-stm32-ide-based-build">
<summary>For STM32 IDE based Build</summary><ul>
<li><p>Install <a class="reference external" href="https://www.st.com/en/development-tools/stm32cubeide.html">STM32CubeIDE</a></p></li>
<li><p>Install <a class="reference external" href="https://www.st.com/en/development-tools/stm32cubemx.html">STM32CubeMX</a></p></li>
<li><p>Install <a class="reference external" href="https://git-scm.com/downloads">Git</a> and add a path of <strong>C:\Program Files\Git\usr\bin\</strong> directory into system environmental path variable (please verify your git installation path is correct).</p></li>
<li><p>Install <a class="reference external" href="https://gnuwin32.sourceforge.net/packages/make.htm">Make</a> in the root of ‘C’ drive without any spaces in the installation path. The path must be <strong>C:\GnuWin32\…</strong>. Add this path into the system environmental path variable (as shown in below screenshot).</p></li>
<li><p>Install <a class="reference external" href="https://developer.arm.com/downloads/-/gnu-rm.">GNU Arm Embedded compiler</a> (for the development, 9-2019-q4-major version is used) and add a path of GNU Arm Embedded Toolchain bin directory into the system environmental path variable (as shown in below screenshot).</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/environmental_variables.png"><img alt="../../_images/environmental_variables.png" src="../../_images/environmental_variables.png" style="width: 400px;" /></a>
</div></blockquote>
</li>
</ul>
</details></details></details></div></blockquote>
</details><details class="summary-building-a-project" open>
<summary>Building a project</summary><blockquote>
<div><p>Once the build enviornment is setup, follow the guide below to build your project
and generate executable file (.bin/.hex)</p>
<details class="summary-windows">
<summary>Windows</summary><details class="summary-mbed">
<summary>Mbed</summary><details class="summary-build-using-web-online-ide">
<summary>Build Using Web/Online IDE</summary><ul>
<li><p>Clone the <a class="reference external" href="https://github.com/analogdevicesinc/precision-converters-firmware">Precision Converters Firmware repository</a> into Keil Studio using “File-&gt;clone…” menu.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/mbed_keil_studio_project_clone.png"><img alt="../../_images/mbed_keil_studio_project_clone.png" src="../../_images/mbed_keil_studio_project_clone.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Once the project repository is imported, wait until all library dependencies are imported as shown in below screenshot. Now, open the ‘.medignore’ file present in the root directory of repository. Add comment syntax (two forward slashes) in front of the project name which you want to build. This will ignore all other projects and build only the comment syntax selected project.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/mbedignore_changes.png"><img alt="../../_images/mbedignore_changes.png" src="../../_images/mbedignore_changes.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Select the target device (default used for development is SDP-K1) and click on ‘Clean build’ option to build the project. After a successful build a binary will be downloaded to your computer- store this on your drive. Drag and drop this binary to the USB drive hosted by your controller board to flash the MCU.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/mbed_build.png"><img alt="../../_images/mbed_build.png" src="../../_images/mbed_build.png" style="width: 400px;" /></a>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you intend to build different project, then modify the .medignore file in the root directory as
mentioned in step2 and clean build project as mentioned in step3</p>
</div>
</details><details class="summary-build-using-make">
<summary>Build Using Make</summary><ul class="simple">
<li><p>Open Git bash and change current directory to project directory (eg. <strong>precision-converters-firmware/projects/ad4130_iio</strong> directory) which you want to build.</p></li>
<li><p>Type <strong>make</strong> on the git bash command prompt to build a project.</p></li>
<li><p>After successful build, binary file will be created into the <strong>Project_Name/build</strong> directory.</p></li>
<li><p>If you want to clean build, type <strong>make reset</strong> on git bash command which deletes all generated build files for the given project.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default TARGET_BOARD is SDP_K1 and COMPILER is GCC_ARM. Current Make based build only support GCC_ARM Compiler.</p>
</div>
<ul class="simple">
<li><p>By default project is built for “SDP_K1” Board and “GCC_ARM” Compiler. If you want to build for other Mbed Board, For example If you want to build the project for “DISCO_F769NI” Board then run <strong>make TARGET_BOARD=DISCO_F769NI</strong> command in git bash command prompt. If you want to clean build, run <strong>make reset TARGET_BOARD=DISCO_F769NI</strong> command to delete the generated build files for the given project.</p></li>
</ul>
</details></details><details class="summary-stm32">
<summary>STM32</summary><details class="summary-build-using-stm32-ide">
<summary>Build Using STM32 IDE</summary><ul>
<li><p>Open the respective project directory by navigating into the “precision_converters_firmware/projects/” folder.</p></li>
<li><p>In the “STM32” folder present within the project directory, double click and open the .ioc file present within.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/stm32_project_directory.png"><img alt="../../_images/stm32_project_directory.png" src="../../_images/stm32_project_directory.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Click on the “Generate Code” option seen on the top right corner</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/stm32_generate_code.png"><img alt="../../_images/stm32_generate_code.png" src="../../_images/stm32_generate_code.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Upon successful generation of drivers for the selected MCU, the autogenerated files would be seen in the same directory where the .ioc file was present. Double click and open the “.project” file seen in the list of files</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/stm32_auto_generated_files.png"><img alt="../../_images/stm32_auto_generated_files.png" src="../../_images/stm32_auto_generated_files.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>After the project is loaded to the STM32CubeIDE, unfold the adxxxx_iio project seen in the project explorer, right click the “app” folder, select “Settings” under the “C/C++ Build” section on the left pane and un-check the “Exclude resources from build” checkbox. This would ensure that the project specific files are included by the build system</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/stm32_exclude_files_option.png"><img alt="../../_images/stm32_exclude_files_option.png" src="../../_images/stm32_exclude_files_option.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>In order to choose STM32 platform in the firmware, select the “ACTIVE_PLATFORM” as “STM32_PLATFORM” in the app_config.h from the respective project.</p></li>
<li><p>Add compiler flags “-u _printf_float” to the project settings.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/stm32_compiler_flag.png"><img alt="../../_images/stm32_compiler_flag.png" src="../../_images/stm32_compiler_flag.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
<li><p>Program by clicking on the “Run adxxxx_iio” option seen or by performing a copy-&gt;paste option of the .hex file seen in the STM32/Debug folder</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/stm32_run_option.png"><img alt="../../_images/stm32_run_option.png" src="../../_images/stm32_run_option.png" style="width: 600px;" /></a>
</div></blockquote>
</li>
</ul>
</details></details></details></div></blockquote>
</details><details class="summary-running-a-project" open>
<summary>Running a project</summary><blockquote>
<div><p>Once the firmware build is successful and binary file is generated, copy the
generated binary into USB drive hosted by your MCU board (e.g. USB drive hosted
by SDP-K1 board on windows). This will flash the binary file into MCU present
on the controller board. Programming might vary based on the tools used for building
a project. The ‘Project Build’ section above talks about this exception at the end
of all build steps.</p>
</div></blockquote>
</details></section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/adi_logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../../index.html"
                          title="previous chapter">Precision-converters-firmware</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../code_style.html"
                          title="next chapter">Code Styles</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/source/build/project_build.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../code_style.html" title="Code Styles"
             >next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Precision-converters-firmware"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">precision-converters-firmware  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Build Guide</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, Analog Devices Inc..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>